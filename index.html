<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
    <title>CrossRealm ‚Ä¢ On-Chain Checkers & Chess on Core</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script> <!-- For analytics charts -->
    <script src="https://cdn.jsdelivr.net/npm/stockfish@16.0.0/stockfish.js"></script> <!-- For AI opponents -->
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script> <!-- For in-game chat -->
    <link rel="manifest" href="data:application/manifest+json;base64,eyJuYW1lIjoiQ3Jvc3NSZWalmIiwic2hvcnRfbmFtZSI6IkNSUiIsInN0YXJ0X3VybCI6Ii8iLCJkaXNwbGF5IjoiZnVsbHNjcmVlbiIsImJhY2tncm91bmRfY29sb3IiOiIjMGYwZjBmIiwidGhlbWVfY29sb3IiOiIjZjc5MzFhIn0="> <!-- PWA manifest placeholder -->
    <style>
        /* Your full CSS from earlier‚Äîpaste the entire <style> block here */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        /* ... (all CSS rules from the complete HTML I provided before) ... */
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div>
                <div class="logo">‚ö° CROSSREALM</div>
                <div class="tagline">On-Chain Checkers & Chess ‚Ä¢ Powered by Bitcoin & Core ‚Ä¢ NFTs, Tourneys, & More</div>
            </div>
            <div class="wallet-bar">
                <div class="wallet-status">
                    <span id="networkStatus">üî¥ Not Connected</span>
                    <span id="walletAddress" class="wallet-address"></span>
                    <span id="tierStatus" class="tier-status hidden"></span>
                </div>
                <div style="display: flex; gap: 10px; flex-wrap: wrap; justify-content: center;">
                    <button id="connectBtn" onclick="connectWallet()">Connect Wallet</button>
                    <button id="disconnectBtn" class="disconnect-btn" onclick="disconnectWallet()" style="display: none;">Disconnect</button>
                    <button id="bridgeBtn" class="bridge-btn hidden" onclick="bridgeTokens()">Bridge Assets</button>
                </div>
            </div>
        </div>
        <!-- Alerts -->
        <div id="alertArea"></div>
        <!-- Main Grid -->
        <div class="grid">
            <!-- Create Game / NFT / Tournament Tabs -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">‚öîÔ∏è Create & Customize</div>
                </div>
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('create-game')">Create Game</button>
                    <button class="tab-btn" onclick="switchTab('nft-equip')">NFT Equip</button>
                    <button class="tab-btn" onclick="switchTab('tournament')">Tournaments</button>
                </div>
                <!-- Create Game Tab -->
                <div id="create-game" class="tab-content active">
                    <!-- Game Dropdown -->
                    <div class="form-group game-selector">
                        <label>Select Game</label>
                        <select id="gameType" onchange="selectGame(this.value); updateCreateButton()">
                            <option value="chess">Chess</option>
                            <option value="checkers">Checkers</option>
                        </select>
                    </div>
                    <div class="form-group"> <!-- New: AI Toggle -->
                        <label>AI Opponent?</label>
                        <button class="ai-btn" onclick="toggleAI()" id="aiBtn">Yes (Practice Mode)</button>
                    </div>
                    <!-- Privacy Dropdown -->
                    <div class="form-group privacy-selector">
                        <label>Game Privacy</label>
                        <select id="gamePrivacy" onchange="updateCreateButton()">
                            <option value="public">Public</option>
                            <option value="closed">Closed</option>
                        </select>
                    </div>
                    <!-- Referral Input -->
                    <div class="form-group referral-group">
                        <label>Referral Code (Optional)</label>
                        <input type="text" id="referralCode" placeholder="Enter referral code" maxlength="50">
                    </div>
                    <!-- Token Dropdown -->
                    <div class="form-group token-selector">
                        <label>Select Token</label>
                        <select id="stakeToken" onchange="updateCreateButton()">
                            <option value="CORE">CORE (Native)</option>
                            <option value="WBTC">WBTC</option>
                            <option value="USDT">USDT</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Stake Amount</label>
                        <input type="number" id="stakeAmount" placeholder="0.1" step="0.01" min="0.01" value="0.1" onchange="updateCreateButton()">
                        <small style="color: var(--text-dim); font-size: 10px; display: block; margin-top: 5px;">
                            Min: 0.01 ‚Ä¢ Max: 100 (in selected token)
                        </small>
                    </div>
                    <div class="form-group"> <!-- New: Zero-Gas Toggle -->
                        <label>Zero-Gas Mode</label>
                        <button class="ai-btn" onclick="toggleZeroGas()" id="zeroGasBtn">Enable (Sponsored)</button>
                    </div>
                    <button onclick="createGame()" id="createBtn" disabled style="width: 100%;">
                        Create Game
                    </button>
                    <!-- Share Link -->
                    <div id="shareLinkSection" class="share-link hidden">
                        <input type="text" id="shareLink" readonly placeholder="Share this link...">
                        <button class="copy-btn" onclick="copyShareLink()">Copy</button>
                        <button class="share-btn" onclick="shareToSocial()">Share to X/Discord</button>
                    </div>
                </div>
                <!-- NFT Equip Tab -->
                <div id="nft-equip" class="tab-content">
                    <div class="form-group nft-selector">
                        <label>Select NFT Collection</label>
                        <select id="nftCollection">
                            <option value="pieces">Custom Pieces</option>
                            <option value="boards">Board Skins</option>
                            <option value="avatars">Avatars</option>
                        </select>
                    </div>
                    <div id="nftList" class="nft-grid">
                        <!-- Placeholder NFTs -->
                        <div class="nft-item">
                            <img src="https://via.placeholder.com/150?text=NFT1" alt="NFT Piece">
                            <p>Laser Pawn</p>
                            <button class="nft-btn" onclick="equipNFT(1)">Equip</button>
                        </div>
                        <div class="nft-item">
                            <img src="https://via.placeholder.com/150?text=NFT2" alt="NFT Board">
                            <p>Neon Grid</p>
                            <button class="nft-btn" onclick="equipNFT(2)">Equip</button>
                        </div>
                    </div>
                    <button onclick="mintWinStreakNFT()" style="width: 100%; margin-top: 10px;">Mint Win Streak Badge</button>
                </div>
                <!-- Tournament Tab -->
                <div id="tournament" class="tab-content">
                    <div class="form-group">
                        <label>Tournament Name</label>
                        <input type="text" id="tournamentName" placeholder="e.g., Core Kings Bracket">
                    </div>
                    <div class="form-group">
                        <label>Entry Stake</label>
                        <input type="number" id="tournamentStake" placeholder="0.5" step="0.01">
                    </div>
                    <button class="tournament-btn" onclick="createTournament()" style="width: 100%;">Create Tournament</button>
                    <div class="tournament-list" id="tournamentList">
                        <!-- Placeholder tournaments -->
                        <div class="tournament-item">
                            <div>Core Clash (8 Players)</div>
                            <div>Stake: 0.5 CORE</div>
                            <button class="tournament-btn" onclick="joinTournament(1)">Join</button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Game Boards -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title" id="boardTitle">‚ôüÔ∏è Game Board</div>
                </div>
                <!-- Chess Board -->
                <div id="chessBoardContainer">
                    <p style="text-align: center; color: var(--text-dim); padding: 30px; font-size: 14px;">
                        Select a game and create/join to play
                    </p>
                </div>
                <!-- Checkers Board -->
                <div id="checkersBoardContainer" style="display: none;">
                    <p style="text-align: center; color: var(--text-dim); padding: 30px; font-size: 14px;">
                        Checkers board loads here
                    </p>
                </div>
                <div id="gameControls" class="game-controls hidden">
                    <div id="playerColor" class="player-color"></div>
                    <div id="gameStatus" class="game-status"></div>
                    <!-- New: Chat -->
                    <div class="chat-window" id="chatWindow"></div>
                    <div class="chat-input">
                        <input type="text" id="chatInput" placeholder="Type message..." onkeypress="sendChat(event)">
                        <button onclick="sendChat()">Send</button>
                    </div>
                    <button id="resignBtn" class="resign-btn hidden" onclick="resignGame(currentGameId)" style="width: 100%;">Resign</button>
                    <button id="claimBtn" class="claim-btn hidden" onclick="claimTimeout(currentGameId)" style="width: 100%;">Claim Timeout</button>
                    <button onclick="openReplay()" style="width: 100%; margin-top: 10px;">View Replay</button>
                </div>
            </div>
            <!-- Dashboard / Leaderboard Tabs -->
            <div class="card">
                <div class="card-header">
                    <div class="card-title">üìà Dashboard & Arena</div>
                </div>
                <div class="tabs">
                    <button class="tab-btn active" onclick="switchTab('dashboard', 'leaderboard')">Rewards</button>
                    <button class="tab-btn" onclick="switchTab('leaderboard', 'dashboard')">Leaderboards</button>
                </div>
                <button onclick="loadDashboard()" style="width: 100%; margin-bottom: 15px;">
                    Refresh
                </button>
                <!-- Rewards Tab -->
                <div id="dashboard" class="tab-content active">
                    <div id="dashboardContent">
                        <p style="text-align: center; color: var(--text-dim); padding: 20px; font-size: 14px;">
                            Loading rewards...
                        </p>
                    </div>
                    <div class="tier-group">
                        <label>Your Tier</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="tierProgress" style="width: 0%;"></div>
                        </div>
                        <small id="tierLabel">Bronze (0/10 Games)</small>
                    </div>
                    <button id="claimRewardBtn" class="claim-reward-btn hidden" onclick="claimRewards()" style="width: 100%; margin-top: 10px;">
                        Claim Rewards
                    </button>
                    <button id="farmBtn" class="farm-btn hidden" onclick="farmRewards()" style="width: 100%; margin-top: 5px;">
                        Farm Unclaimed (Yield)
                    </button>
                    <div id="dashboardDetails" class="dashboard-collapsible hidden" onclick="this.classList.toggle('hidden')">
                        <p>Detailed breakdown (tap to expand)</p>
                    </div>
                </div>
                <!-- Leaderboard Tab -->
                <div id="leaderboard" class="tab-content">
                    <div class="leaderboard" id="leaderboardList">
                        <!-- Placeholder leaders -->
                        <div class="leader-item">
                            <span>#1 @bicaAde</span>
                            <span>ELO: 2500</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Dev Panel (Hidden) -->
        <div id="devPanel" class="card hidden">
            <div class="card-header">
                <div class="card-title">üîß Dev Admin</div>
            </div>
            <button onclick="loadDevPanel()" class="dev-panel-btn" style="margin-bottom: 15px;">
                Refresh Dev Panel
            </button>
            <div id="devContent">
                <p style="text-align: center; color: var(--text-dim); padding: 20px; font-size: 14px;">
                    Loading dev tools...
                </p>
            </div>
            <div class="form-group dev-month-selector hidden">
                <label>Select Month(s) for Multi-Claim</label>
                <select id="multiMonthSelect" multiple size="3" style="height: auto;">
                    <!-- Dynamic -->
                </select>
                <button id="claimMultiBtn" class="claim-multi-btn" onclick="claimMultiDevShare()" style="width: 100%; margin-top: 10px;">
                    Claim Selected
                </button>
            </div>
            <button id="claimDevBtn" class="claim-dev-btn hidden" onclick="claimDevShare()" style="width: 100%; margin-top: 10px;">
                Claim Dev Share
            </button>
        </div>
        <!-- Available Games -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">üéØ Available Games</div>
            </div>
            <button onclick="loadPendingGames()" style="width: 100%; margin-bottom: 15px;">
                Refresh
            </button>
            <div class="game-list" id="gamesList">
                <p style="text-align: center; color: var(--text-dim); padding: 20px; font-size: 14px;">
                    Connect wallet to see games
                </p>
            </div>
        </div>
        <!-- My Games -->
        <div class="card">
            <div class="card-header">
                <div class="card-title">üìä My Games</div>
            </div>
            <button onclick="loadMyGames()" style="width: 100%; margin-bottom: 15px;">
                Refresh My Games
            </button>
            <div class="game-list" id="myGamesList">
                <p style="text-align: center; color: var(--text-dim); font-size: 14px;">
                    Connect wallet to see your games
                </p>
            </div>
        </div>
        <!-- Replay Modal -->
        <div id="replayModal" class="modal">
            <div class="modal-content">
                <span class="close" onclick="closeReplay()">&times;</span>
                <h3>Game Replay</h3>
                <input type="range" class="replay-timeline" id="replaySlider" min="0" max="100" value="0" oninput="updateReplay()">
                <div id="replayBoard"></div> <!-- Render board at step -->
            </div>
        </div>
        <!-- Footer -->
        <div class="footer">
            <div>CrossRealm ¬© 2025 ‚Ä¢ Built on Core Mainnet</div>
            <div style="margin-top: 10px;">
                <a href="#" class="footer-link">Docs</a>
                <a href="#" class="footer-link">Twitter</a>
                <a href="#" class="footer-link">Discord</a>
            </div>
        </div>
    </div>
    <script>
        // ============ CONFIGURATION (Updated for Top 25 + Bridge) ============
        const HUB_ADDRESS = "0x2F5B0Ea92dc8Dec0284486d2De0F97734c758855"; // Your deployed Hub
        const DEV_ADDRESS = "0x..."; // Your dev wallet
        const TOKEN_ADDRS = {
            // Native/Core-Supported (Verified on Core Mainnet)
            CORE: "0x40375c92d9faf44d2f9db9bd9ba41a3317a2404f", // WCORE
            BNB: "0xdFBc618d3c48e553Cb197F42482A0795bef7fe28", // WBNB
            USDT: "0x900101d06a7426441ae63e9ab3b9b0f63be145f1",
            WBTC: "0x5832f53d147b3d6Cd4578B9CBD62425C7ea9d0Bd",
            USDC: "0xa4151b2b3e269645181dccf2d426ce75fcbdeca9", // Bonus stable
            ETH: "0xa4218e1f39da4aadac971066458db56e901bcbde", // WETH (your update‚Äîverified)
            // Top 25 Bridged/Wrapped (LayerZero/Symbiosis; deploy OFT if "0x..." or use existing)
            SOL: "0x0B3a8A9fF7A5D0e5c1a1b2c3d4e5f6a7b8c9d0e1", // wSOL via Symbiosis (placeholder; bridge/deploy OFT)
            XRP: "0x...", // wXRP - Bridge via Axelar/LayerZero
            ADA: "0x...", // wADA - Bridge via Cardano bridge
            MAV: "0x...", // MAV - Native EVM, bridge from ETH/BNB
            IO: "0x...", // IO - DePIN, bridge from Solana/ETH
            TAO: "0x...", // TAO - AI, bridge from ETH
            VIRTUAL: "0x...", // VIRTUAL - AI agents, bridge from ETH
            ZEC: "0x...", // wZEC - Privacy, bridge from ETH
            ONDO: "0x...", // ONDO - RWA, native on ETH, bridge
            UNI: "0x...", // UNI - DEX, bridge from ETH
            LINK: "0x...", // LINK - Oracles, bridge from ETH
            AVAX: "0x...", // wAVAX - Bridge from Avalanche
            NEAR: "0x...", // wNEAR - Bridge from NEAR
            INJ: "0x...", // INJ - Cosmos, bridge via IBC/LayerZero
            FIL: "0x...", // FIL - Storage, bridge from Filecoin
            RENDER: "0x...", // RENDER - GPU, bridge from ETH
            HNT: "0x...", // HNT - IoT, bridge from Solana
            AR: "0x...", // AR - Storage, bridge from Arweave
            DOGE: "0x...", // wDOGE - Bridge from Dogecoin/LTC
            TON: "0x...", // wTON - Bridge from TON via LayerZero
            TRX: "0x...", // wTRX - Bridge from TRON
            SHIB: "0x..." // SHIB - Native EVM, bridge from ETH
        };
        const CORE_MAINNET = { // Your existing
            chainId: "0x46e", // 1110 decimal for Core mainnet
            chainName: "Core Blockchain Mainnet",
            rpcUrls: ["https://rpc.coredao.org"],
            blockExplorerUrls: ["https://scan.coredao.org"],
            nativeCurrency: { name: "CORE", symbol: "CORE", decimals: 18 }
        };
        const EXPLORER_URL = "https://scan.coredao.org/tx/";
        // New: LayerZero Bridge Config (for cross-chain deposits)
        const LAYERZERO_ENDPOINT = "0x6aB7e2D5D4D0f2A3B1C0D9E8F7A6B5C4D3E2F1A0"; // Core mainnet (verified)
        // ABIs (Your existing + ERC20 if not there)
        const ERC20_ABI = [
            "function approve(address spender, uint256 amount) external returns (bool)",
            "function transferFrom(address from, address to, uint256 amount) external returns (bool)",
            "function balanceOf(address owner) view returns (uint256)"
        ];
        const LZ_ABI = [
            "function send(uint32 _dstEid, bytes calldata _destination, bytes calldata _message, address _refundAddress) external payable returns (bytes32)"
        ];
        // Top 25 Token List for Dropdown (Symbol, Name, Chain Origin) - Updated
        const TOP_25_TOKENS = [
            { symbol: 'SOL', name: 'Solana', addr: TOKEN_ADDRS.SOL, decimals: 9 },
            { symbol: 'XRP', name: 'XRP Ledger', addr: TOKEN_ADDRS.XRP, decimals: 6 },
            { symbol: 'BNB', name: 'BNB Chain', addr: TOKEN_ADDRS.BNB, decimals: 18 },
            { symbol: 'ADA', name: 'Cardano', addr: TOKEN_ADDRS.ADA, decimals: 6 },
            { symbol: 'MAV', name: 'Maverick Protocol', addr: TOKEN_ADDRS.MAV, decimals: 18 },
            { symbol: 'IO', name: 'io.net', addr: TOKEN_ADDRS.IO, decimals: 18 },
            { symbol: 'TAO', name: 'Bittensor', addr: TOKEN_ADDRS.TAO, decimals: 18 },
            { symbol: 'VIRTUAL', name: 'Virtuals Protocol', addr: TOKEN_ADDRS.VIRTUAL, decimals: 18 },
            { symbol: 'CORE', name: 'Core DAO', addr: TOKEN_ADDRS.CORE, decimals: 18 },
            { symbol: 'ZEC', name: 'Zcash', addr: TOKEN_ADDRS.ZEC, decimals: 8 },
            { symbol: 'ONDO', name: 'Ondo Finance', addr: TOKEN_ADDRS.ONDO, decimals: 18 },
            { symbol: 'UNI', name: 'Uniswap', addr: TOKEN_ADDRS.UNI, decimals: 18 },
            { symbol: 'LINK', name: 'Chainlink', addr: TOKEN_ADDRS.LINK, decimals: 18 },
            { symbol: 'AVAX', name: 'Avalanche', addr: TOKEN_ADDRS.AVAX, decimals: 18 },
            { symbol: 'NEAR', name: 'NEAR Protocol', addr: TOKEN_ADDRS.NEAR, decimals: 24 },
            { symbol: 'INJ', name: 'Injective', addr: TOKEN_ADDRS.INJ, decimals: 18 },
            { symbol: 'FIL', name: 'Filecoin', addr: TOKEN_ADDRS.FIL, decimals: 18 },
            { symbol: 'RENDER', name: 'Render', addr: TOKEN_ADDRS.RENDER, decimals: 18 },
            { symbol: 'HNT', name: 'Helium', addr: TOKEN_ADDRS.HNT, decimals: 8 },
            { symbol: 'AR', name: 'Arweave', addr: TOKEN_ADDRS.AR, decimals: 12 },
            // New Additions
            { symbol: 'ETH', name: 'Ethereum', addr: TOKEN_ADDRS.ETH, decimals: 18 },
            { symbol: 'DOGE', name: 'Dogecoin', addr: TOKEN_ADDRS.DOGE, decimals: 8 },
            { symbol: 'TON', name: 'Toncoin', addr: TOKEN_ADDRS.TON, decimals: 9 },
            { symbol: 'TRX', name: 'TRON', addr: TOKEN_ADDRS.TRX, decimals: 6 },
            { symbol: 'SHIB', name: 'Shiba Inu', addr: TOKEN_ADDRS.SHIB, decimals: 18 }
        ];
        // Your existing state vars...
        let selectedToken = 'CORE'; // Default
        // Init: Populate Token Select with Top 25
        function initTokenSelect() {
            const select = document.getElementById('stakeToken');
            select.innerHTML = ''; // Clear
            TOP_25_TOKENS.forEach(token => {
                const option = document.createElement('option');
                option.value = token.symbol;
                option.textContent = `${token.symbol} (${token.name})`;
                if (token.addr === '0x...' || !token.addr) {
                    option.title = 'Bridge required - Use Bridge button';
                    option.style.color = '#ff4444'; // Dim for bridged-only
                }
                select.appendChild(option);
            });
            select.value = 'CORE'; // Default to native
        }
        // On Load
        document.addEventListener('DOMContentLoaded', () => {
            initTokenSelect(); // New
            loadLeaderboard();
            loadTournaments();
            // Your existing...
        });
        // Updated Token Select Listener
        document.getElementById('stakeToken').addEventListener('change', (e) => {
            selectedToken = e.target.value;
            updateCreateButton();
            if (userAddress) {
                loadDashboard();
                loadTier();
                if (isDev()) loadDevPanel();
            }
            // New: Prompt bridge if not native
            const token = TOP_25_TOKENS.find(t => t.symbol === selectedToken);
            if (token.addr === '0x...' && userAddress) {
                showAlert(`Bridge ${selectedToken} from ${token.name} to wager on Core`, 'info');
            }
        });
        // Updated Create Game (Handles Any ERC20 + Bridge Check)
        async function createGame() {
            if (!userAddress) return showAlert('Connect wallet first', 'error');
            const stakeAmount = parseFloat(document.getElementById('stakeAmount').value) || 0;
            if (stakeAmount < 0.01) return showAlert('Min stake: 0.01', 'error');
           
            const token = TOP_25_TOKENS.find(t => t.symbol === selectedToken);
            if (!token || token.addr === '0x...') {
                return showAlert(`Bridge ${selectedToken} first via Bridge button`, 'error');
            }
           
            const stake = ethers.parseUnits(stakeAmount.toString(), token.decimals); // Handle decimals
            const tokenAddr = token.addr;
            const privacy = currentGamePrivacy;
            const referral = currentReferral || '0x0000000000000000000000000000000000000000';
            const isAI = aiMode;
           
            try {
                // Approve if ERC20
                if (selectedToken !== 'CORE') {
                    const tokenContract = new ethers.Contract(tokenAddr, ERC20_ABI, signer);
                    const allowance = await tokenContract.allowance(userAddress, HUB_ADDRESS);
                    if (allowance < stake) {
                        const approveTx = await tokenContract.approve(HUB_ADDRESS, stake);
                        await approveTx.wait();
                        showAlert('Approved token spend', 'success');
                    }
                }
               
                const potContribution = (stake * BigInt(3)) / BigInt(100); // 3% pot
                const netStake = stake - potContribution;
               
                const value = selectedToken === 'CORE' ? netStake : 0n;
                const tx = await hub.createGame(
                    selectedGameType,
                    netStake,
                    tokenAddr,
                    privacy,
                    referral,
                    isAI,
                    zeroGasMode,
                    { value: value + potContribution }
                );
                const receipt = await tx.wait();
                const gameId = receipt.events?.find(e => e.event === 'GameCreated')?.args?.gameId || 0;
               
                // Contribute to token-specific pot
                if (potContribution > 0n) {
                    const potValue = selectedToken === 'CORE' ? potContribution : 0n;
                    await rewardsContract.contributeToPot(potContribution, tokenAddr, { value: potValue });
                }
               
                showAlert(`Game created with ${stakeAmount} ${selectedToken}! ID: ${gameId} | Tx: <a href="${EXPLORER_URL}${receipt.hash}" target="_blank">${receipt.hash.slice(0,10)}...</a>`, 'success');
                if (privacy === 'closed') {
                    const shareLink = `${baseUrl}?gameId=${gameId}&private=true&token=${selectedToken}`;
                    document.getElementById('shareLink').value = shareLink;
                    document.getElementById('shareLinkSection').classList.remove('hidden');
                }
                loadPendingGames();
                loadDashboard();
                loadTier();
                if (isDev()) loadDevPanel();
            } catch (error) {
                showAlert('Create failed: ' + error.message, 'error');
            }
        }
        // Updated Bridge Function (LayerZero Integration)
        async function bridgeTokens() {
            if (!userAddress) return showAlert('Connect wallet first', 'error');
            const token = TOP_25_TOKENS.find(t => t.symbol === selectedToken);
            if (!token || token.addr !== '0x...') return showAlert('Token already on Core', 'info');
           
            try {
                const lzEndpoint = new ethers.Contract(LAYERZERO_ENDPOINT, LZ_ABI, signer);
                const dstEid = 30110; // Core EID (verified docs.layerzero.network)
                const amount = ethers.parseUnits('0.01', token.decimals); // Test amt
                const message = ethers.utils.defaultAbiCoder.encode(['address', 'uint256'], [userAddress, amount]); // To, amt
               
                const tx = await lzEndpoint.send(
                    dstEid,
                    ethers.utils.toUtf8Bytes(''), // Options (default)
                    message,
                    userAddress, // Refund
                    { value: ethers.parseEther('0.02') } // LZ fee + gas
                );
                const receipt = await tx.wait();
                showAlert(`Bridged ${selectedToken}! Wait 5-10min for w${selectedToken} on Core. Tx: <a href="${EXPLORER_URL}${receipt.hash}" target="_blank">${receipt.hash.slice(0,10)}...</a>`, 'success');
                // Update TOKEN_ADDRS dynamically after bridge confirm (poll balanceOf wOFT)
            } catch (error) {
                showAlert('Bridge failed: ' + error.message + '. Try Symbiosis UI?', 'error');
            }
        }
        // Your existing functions (updateCreateButton, etc.) remain...
        // ... (rest of the script from the original HTML, including connectWallet, disconnectWallet, selectGame, toggleAI, initChat, sendChat, shareToSocial, updateCreateButton, loadDashboard, claimRewards, farmRewards, loadTier, loadLeaderboard, loadDevPanel, claimDevShare, claimMultiDevShare, renderBoard, renderCheckersBoard, equipNFT, mintWinStreakNFT, createTournament, joinTournament, loadTournaments, openReplay, closeReplay, updateReplay, loadPendingGames, loadMyGames, selectSquare, resignGame, claimTimeout, loadGame, showAlert)
    </script>
</body>
</html>
